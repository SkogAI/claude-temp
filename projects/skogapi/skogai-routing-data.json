{
  "layers": {
    "global": {
      "label": "Global Config",
      "color": "#fbbf24",
      "fill": "#422006",
      "border": "#854d0e"
    },
    "hq": {
      "label": "Headquarters",
      "color": "#3b82f6",
      "fill": "#172554",
      "border": "#1d4ed8"
    },
    "framework": {
      "label": "Framework Guard",
      "color": "#ef4444",
      "fill": "#450a0a",
      "border": "#b91c1c"
    },
    "routing": {
      "label": "Routing / Agents",
      "color": "#8b5cf6",
      "fill": "#2e1065",
      "border": "#6d28d9"
    },
    "memory": {
      "label": "Memory System",
      "color": "#10b981",
      "fill": "#022c22",
      "border": "#047857"
    },
    "knowledge": {
      "label": "Knowledge Base",
      "color": "#06b6d4",
      "fill": "#083344",
      "border": "#0e7490"
    },
    "tools": {
      "label": "Tools & Scripts",
      "color": "#f97316",
      "fill": "#431407",
      "border": "#c2410c"
    },
    "tasks": {
      "label": "Task System",
      "color": "#ec4899",
      "fill": "#500724",
      "border": "#be185d"
    },
    "docs": {
      "label": "Documentation",
      "color": "#64748b",
      "fill": "#1e293b",
      "border": "#475569"
    },
    "endpoint": {
      "label": "Endpoints",
      "color": "#e879f9",
      "fill": "none",
      "border": "#a855f7",
      "shape": "pill"
    }
  },
  "connTypes": {
    "route": {
      "label": "@-route",
      "color": "#3b82f6",
      "dash": "",
      "desc": "CLAUDE.md routing reference"
    },
    "skill": {
      "label": "skill/agent",
      "color": "#8b5cf6",
      "dash": "8,4",
      "desc": "Agent or skill invocation"
    },
    "reads": {
      "label": "reads from",
      "color": "#10b981",
      "dash": "6,3",
      "desc": "Data read / context load"
    },
    "contains": {
      "label": "contains",
      "color": "#64748b",
      "dash": "3,3",
      "desc": "Parent-child containment"
    },
    "lifecycle": {
      "label": "lifecycle",
      "color": "#ec4899",
      "dash": "12,4",
      "desc": "Task lifecycle flow"
    },
    "executes": {
      "label": "executes",
      "color": "#e879f9",
      "dash": "4,2",
      "desc": "Runs a CLI tool or external command"
    },
    "io": {
      "label": "I/O",
      "color": "#facc15",
      "dash": "6,2,2,2",
      "desc": "Input/output with external system"
    }
  },
  "nodes": [
    {
      "id": "global-claude",
      "label": "CLAUDE.md",
      "subtitle": "/skogai/config/claude/CLAUDE.md",
      "layer": "global",
      "x": 500,
      "y": 40,
      "w": 160,
      "h": 50,
      "desc": "Absolute entrypoint. Every session loads this first. Routes to user identity, definitions, and headquarters."
    },
    {
      "id": "user-md",
      "label": "user.md",
      "subtitle": "~/docs/skogix/user.md",
      "layer": "global",
      "x": 180,
      "y": 40,
      "w": 140,
      "h": 50,
      "desc": "Who skogix is. Communication style, code preferences, knowledge sharing philosophy."
    },
    {
      "id": "definitions-md",
      "label": "definitions.md",
      "subtitle": "~/docs/skogix/definitions.md",
      "layer": "global",
      "x": 820,
      "y": 40,
      "w": 150,
      "h": 50,
      "desc": "Terminology context. Defines: task, todo, plan, goal, agent, branch-name, @-prefix, etc."
    },
    {
      "id": "hq-claude",
      "label": "CLAUDE.md",
      "subtitle": "~/claude/CLAUDE.md",
      "layer": "hq",
      "x": 500,
      "y": 150,
      "w": 160,
      "h": 50,
      "desc": "Claude's home and working directory. Routes task work to task-manager agent, framework questions to .skogai."
    },
    {
      "id": "skogai-claude",
      "label": ".skogai/CLAUDE.md",
      "subtitle": "~/claude/.skogai/CLAUDE.md",
      "layer": "framework",
      "x": 780,
      "y": 150,
      "w": 170,
      "h": 50,
      "desc": "Guard rule: when .skogai contents are unclear, ask the user directly. Prevents guessing."
    },
    {
      "id": "task-manager",
      "label": "task-manager",
      "subtitle": ".claude/agents/task-manager.md",
      "layer": "routing",
      "x": 280,
      "y": 270,
      "w": 160,
      "h": 50,
      "desc": "Owns all skogai-todo interactions. Main claude instance delegates task work here. Full lifecycle: plan, setup, execute, done."
    },
    {
      "id": "todo-plan",
      "label": "/todo:plan",
      "subtitle": ".claude/commands/todo/plan.md",
      "layer": "routing",
      "x": 80,
      "y": 380,
      "w": 130,
      "h": 44,
      "desc": "Big picture planning: review all tasks, set dependencies, priorities, ordering."
    },
    {
      "id": "todo-setup",
      "label": "/todo:setup",
      "subtitle": ".claude/commands/todo/setup.md",
      "layer": "routing",
      "x": 230,
      "y": 380,
      "w": 130,
      "h": 44,
      "desc": "Prepare a task: activate, lock, create worktree, write handover with context & acceptance criteria."
    },
    {
      "id": "todo-execute",
      "label": "/todo:execute",
      "subtitle": ".claude/commands/todo/execute.md",
      "layer": "routing",
      "x": 380,
      "y": 380,
      "w": 140,
      "h": 44,
      "desc": "Do the work: read handover, implement in worktree, commit as you go, verify acceptance criteria."
    },
    {
      "id": "todo-done",
      "label": "/todo:done",
      "subtitle": ".claude/commands/todo/done.md",
      "layer": "routing",
      "x": 540,
      "y": 380,
      "w": 130,
      "h": 44,
      "desc": "Close out: review, PR, unlock, set state done, sync GitHub, remove worktree."
    },
    {
      "id": "memory-skogai",
      "label": "SKOGAI.md",
      "subtitle": ".skogai/memory/SKOGAI.md",
      "layer": "memory",
      "x": 720,
      "y": 270,
      "w": 140,
      "h": 50,
      "desc": "Memory system overview. Defines structure: context/, decisions.md, journal/."
    },
    {
      "id": "context-current",
      "label": "current.md",
      "subtitle": ".skogai/memory/context/current.md",
      "layer": "memory",
      "x": 620,
      "y": 380,
      "w": 140,
      "h": 44,
      "desc": "What we're actively working on. Read at session start, updated at session end."
    },
    {
      "id": "decisions-log",
      "label": "decisions.md",
      "subtitle": ".skogai/memory/decisions.md",
      "layer": "memory",
      "x": 780,
      "y": 380,
      "w": 140,
      "h": 44,
      "desc": "Append-only quick decision log. During work, append quick notes here."
    },
    {
      "id": "journal",
      "label": "journal/",
      "subtitle": ".skogai/memory/journal/*.md",
      "layer": "memory",
      "x": 940,
      "y": 380,
      "w": 130,
      "h": 44,
      "desc": "Timestamped session logs. Full history from 2025-03 through 2026-02."
    },
    {
      "id": "conventions",
      "label": "conventions.md",
      "subtitle": ".skogai/knowledge/conventions.md",
      "layer": "knowledge",
      "x": 80,
      "y": 510,
      "w": 150,
      "h": 44,
      "desc": "File/folder naming rules. SKOGAI.md, CLAUDE.md, INBOX.list, README.md roles defined here."
    },
    {
      "id": "rules",
      "label": "rules.md",
      "subtitle": ".skogai/knowledge/rules.md",
      "layer": "knowledge",
      "x": 250,
      "y": 510,
      "w": 130,
      "h": 44,
      "desc": "Atomic rules: @ is not filesystem, .list files are append-only, inbox messaging protocol."
    },
    {
      "id": "at-linking",
      "label": "at-linking.md",
      "subtitle": ".skogai/docs/at-linking.md",
      "layer": "knowledge",
      "x": 400,
      "y": 510,
      "w": 140,
      "h": 44,
      "desc": "CRITICAL: How @ notation works. @ = permission + context. Works 6 levels deep. Subagents need @-links to read files."
    },
    {
      "id": "arch-decisions",
      "label": "decisions/",
      "subtitle": ".skogai/knowledge/decisions/",
      "layer": "knowledge",
      "x": 560,
      "y": 510,
      "w": 150,
      "h": 44,
      "desc": "Architecture Decision Records. Key dates: 2026-01-20 (conventions), 2026-02-06 (env), 2026-02-18 (task-manager)."
    },
    {
      "id": "skogai-todo",
      "label": "skogai-todo.md",
      "subtitle": ".skogai/tools/skogai-todo.md",
      "layer": "tools",
      "x": 720,
      "y": 510,
      "w": 150,
      "h": 44,
      "desc": "Complete CLI reference for task management. Used exclusively by task-manager agent."
    },
    {
      "id": "argcfile",
      "label": "Argcfile.sh",
      "subtitle": ".skogai/Argcfile.sh",
      "layer": "tools",
      "x": 890,
      "y": 510,
      "w": 140,
      "h": 44,
      "desc": "argc-based task runner framework. Shared automation scripts."
    },
    {
      "id": "context-scripts",
      "label": "context/*.sh",
      "subtitle": ".skogai/scripts/context/",
      "layer": "tools",
      "x": 890,
      "y": 270,
      "w": 150,
      "h": 50,
      "desc": "Context loading orchestrator: git, journal, memory, model, todo, workspace context loaders."
    },
    {
      "id": "task-files",
      "label": "tasks/",
      "subtitle": ".skogai/tasks/*.md",
      "layer": "tasks",
      "x": 80,
      "y": 620,
      "w": 130,
      "h": 44,
      "desc": "20+ task files with YAML frontmatter. Managed by skogai-todo CLI."
    },
    {
      "id": "state-locks",
      "label": "state/locks/",
      "subtitle": ".skogai/state/locks/",
      "layer": "tasks",
      "x": 250,
      "y": 620,
      "w": 140,
      "h": 44,
      "desc": "Multi-agent coordination. Lock files prevent concurrent task work."
    },
    {
      "id": "workflows-prep",
      "label": "preparation.md",
      "subtitle": ".skogai/workflows/tasks/preparation.md",
      "layer": "tasks",
      "x": 420,
      "y": 620,
      "w": 150,
      "h": 44,
      "desc": "How to prepare tasks: plan -> setup -> active. Worktree creation, handover writing."
    },
    {
      "id": "workflows-exec",
      "label": "execution.md",
      "subtitle": ".skogai/workflows/tasks/execution.md",
      "layer": "tasks",
      "x": 590,
      "y": 620,
      "w": 140,
      "h": 44,
      "desc": "How to execute tasks: read handover, do work in worktree, commit, verify."
    },
    {
      "id": "inbox",
      "label": "inbox.list",
      "subtitle": ".skogai/inbox/inbox.list",
      "layer": "tasks",
      "x": 760,
      "y": 620,
      "w": 130,
      "h": 44,
      "desc": "Append-only message inbox. Cross-project communication channel."
    },
    {
      "id": "dotfiles",
      "label": "dotfiles/",
      "subtitle": ".skogai/dotfiles/",
      "layer": "docs",
      "x": 920,
      "y": 620,
      "w": 130,
      "h": 44,
      "desc": "Git hooks (pre-commit, pre-push), branch validation, worktree tracking. Safety infrastructure."
    },
    {
      "id": "nelson",
      "label": "nelson/",
      "subtitle": ".skogai/projects/nelson/CLAUDE.md",
      "layer": "routing",
      "x": 940,
      "y": 150,
      "w": 130,
      "h": 50,
      "desc": "Sub-project with its own CLAUDE.md router. Royal Navy themed agent coordination skill."
    },
    {
      "id": "ep-skogai-todo",
      "label": "skogai-todo",
      "subtitle": "CLI",
      "layer": "endpoint",
      "x": 140,
      "y": 740,
      "w": 130,
      "h": 38,
      "desc": "Task management CLI. Manages task lifecycle, state transitions, worktrees, locks. The actual binary that task-manager calls."
    },
    {
      "id": "ep-gh",
      "label": "gh",
      "subtitle": "GitHub CLI",
      "layer": "endpoint",
      "x": 300,
      "y": 740,
      "w": 100,
      "h": 38,
      "desc": "GitHub CLI. Creates PRs, syncs issues, manages remote state. Used by /todo:done and task-manager."
    },
    {
      "id": "ep-git",
      "label": "git",
      "subtitle": "version control",
      "layer": "endpoint",
      "x": 430,
      "y": 740,
      "w": 100,
      "h": 38,
      "desc": "Git version control. Worktree management, commits, branches, hooks. Foundation of task isolation."
    },
    {
      "id": "ep-argc",
      "label": "argc",
      "subtitle": "task runner",
      "layer": "endpoint",
      "x": 560,
      "y": 740,
      "w": 100,
      "h": 38,
      "desc": "argc CLI framework. Parses Argcfile.sh, provides shell completion, runs tasks with argument parsing."
    },
    {
      "id": "ep-terminal",
      "label": "terminal",
      "subtitle": "user I/O",
      "layer": "endpoint",
      "x": 720,
      "y": 740,
      "w": 120,
      "h": 38,
      "desc": "User terminal / stdin+stdout. Where the human interacts. Session start, prompts, output."
    },
    {
      "id": "ep-github",
      "label": "GitHub",
      "subtitle": "remote",
      "layer": "endpoint",
      "x": 870,
      "y": 740,
      "w": 120,
      "h": 38,
      "desc": "GitHub remote. Issues, PRs, repo state. The external source of truth for project coordination."
    },
    {
      "id": "ep-ollama",
      "label": "ollama",
      "subtitle": "local LLM",
      "layer": "endpoint",
      "x": 1020,
      "y": 740,
      "w": 120,
      "h": 38,
      "desc": "Ollama local LLM. Used for local inference, RAG queries, and lightweight AI tasks without API calls."
    },
    {
      "id": "ep-filesystem",
      "label": "filesystem",
      "subtitle": "worktrees / files",
      "layer": "endpoint",
      "x": 1020,
      "y": 620,
      "w": 130,
      "h": 38,
      "desc": "Local filesystem. Worktrees, task files, lock files, config. The actual disk state that all tools operate on."
    },
    {
      "id": "user-1771401950377",
      "label": "testnode",
      "subtitle": "/home/skogix/claude/testnode.md",
      "layer": "hq",
      "x": 60,
      "y": 150,
      "w": 130,
      "h": 50,
      "desc": "testnode"
    }
  ],
  "connections": [
    {
      "from": "global-claude",
      "to": "user-md",
      "type": "route",
      "label": "@-ref"
    },
    {
      "from": "global-claude",
      "to": "definitions-md",
      "type": "route",
      "label": "@-ref"
    },
    {
      "from": "global-claude",
      "to": "hq-claude",
      "type": "route",
      "label": "@-ref"
    },
    {
      "from": "hq-claude",
      "to": "task-manager",
      "type": "route",
      "label": "delegates tasks"
    },
    {
      "from": "hq-claude",
      "to": "skogai-claude",
      "type": "route",
      "label": "framework ref"
    },
    {
      "from": "skogai-claude",
      "to": "nelson",
      "type": "route",
      "label": "sub-project"
    },
    {
      "from": "task-manager",
      "to": "todo-plan",
      "type": "skill",
      "label": "skill"
    },
    {
      "from": "task-manager",
      "to": "todo-setup",
      "type": "skill",
      "label": "skill"
    },
    {
      "from": "task-manager",
      "to": "todo-execute",
      "type": "skill",
      "label": "skill"
    },
    {
      "from": "task-manager",
      "to": "todo-done",
      "type": "skill",
      "label": "skill"
    },
    {
      "from": "todo-plan",
      "to": "todo-setup",
      "type": "lifecycle",
      "label": "1->2"
    },
    {
      "from": "todo-setup",
      "to": "todo-execute",
      "type": "lifecycle",
      "label": "2->3"
    },
    {
      "from": "todo-execute",
      "to": "todo-done",
      "type": "lifecycle",
      "label": "3->4"
    },
    {
      "from": "todo-setup",
      "to": "workflows-prep",
      "type": "reads",
      "label": "@-reads"
    },
    {
      "from": "todo-execute",
      "to": "workflows-exec",
      "type": "reads",
      "label": "@-reads"
    },
    {
      "from": "task-manager",
      "to": "skogai-todo",
      "type": "reads",
      "label": "CLI ref"
    },
    {
      "from": "memory-skogai",
      "to": "context-current",
      "type": "contains"
    },
    {
      "from": "memory-skogai",
      "to": "decisions-log",
      "type": "contains"
    },
    {
      "from": "memory-skogai",
      "to": "journal",
      "type": "contains"
    },
    {
      "from": "context-scripts",
      "to": "memory-skogai",
      "type": "reads",
      "label": "loads"
    },
    {
      "from": "context-scripts",
      "to": "context-current",
      "type": "reads",
      "label": "loads"
    },
    {
      "from": "todo-plan",
      "to": "task-files",
      "type": "reads",
      "label": "reads tasks"
    },
    {
      "from": "todo-setup",
      "to": "state-locks",
      "type": "reads",
      "label": "acquires lock"
    },
    {
      "from": "todo-done",
      "to": "state-locks",
      "type": "reads",
      "label": "releases lock"
    },
    {
      "from": "skogai-todo",
      "to": "task-files",
      "type": "reads",
      "label": "manages"
    },
    {
      "from": "at-linking",
      "to": "rules",
      "type": "reads",
      "label": "defines"
    },
    {
      "from": "conventions",
      "to": "rules",
      "type": "reads",
      "label": "extends"
    },
    {
      "from": "todo-done",
      "to": "inbox",
      "type": "reads",
      "label": "notifies"
    },
    {
      "from": "skogai-todo",
      "to": "ep-skogai-todo",
      "type": "executes",
      "label": "runs"
    },
    {
      "from": "todo-done",
      "to": "ep-gh",
      "type": "executes",
      "label": "gh pr create"
    },
    {
      "from": "todo-setup",
      "to": "ep-git",
      "type": "executes",
      "label": "git worktree"
    },
    {
      "from": "todo-done",
      "to": "ep-git",
      "type": "executes",
      "label": "git merge"
    },
    {
      "from": "argcfile",
      "to": "ep-argc",
      "type": "executes",
      "label": "runs"
    },
    {
      "from": "ep-gh",
      "to": "ep-github",
      "type": "io",
      "label": "API"
    },
    {
      "from": "ep-git",
      "to": "ep-filesystem",
      "type": "io",
      "label": "read/write"
    },
    {
      "from": "ep-skogai-todo",
      "to": "ep-filesystem",
      "type": "io",
      "label": "task state"
    },
    {
      "from": "task-files",
      "to": "ep-filesystem",
      "type": "io",
      "label": "persisted"
    },
    {
      "from": "state-locks",
      "to": "ep-filesystem",
      "type": "io",
      "label": "lock files"
    },
    {
      "from": "global-claude",
      "to": "ep-terminal",
      "type": "io",
      "label": "session start"
    },
    {
      "from": "context-scripts",
      "to": "ep-ollama",
      "type": "executes",
      "label": "local inference"
    },
    {
      "from": "dotfiles",
      "to": "ep-git",
      "type": "reads",
      "label": "hooks"
    }
  ],
  "presets": {
    "full": {
      "label": "Full System",
      "layers": [
        "global",
        "hq",
        "framework",
        "routing",
        "memory",
        "knowledge",
        "tools",
        "tasks",
        "docs",
        "endpoint"
      ]
    },
    "routing": {
      "label": "Routing Flow",
      "layers": [
        "global",
        "hq",
        "framework",
        "routing"
      ]
    },
    "tasks": {
      "label": "Task Lifecycle",
      "layers": [
        "routing",
        "tasks",
        "tools",
        "endpoint"
      ]
    },
    "memory": {
      "label": "Memory System",
      "layers": [
        "memory",
        "tools",
        "knowledge"
      ]
    },
    "knowledge": {
      "label": "Knowledge Base",
      "layers": [
        "knowledge",
        "docs"
      ]
    },
    "discovery": {
      "label": "Agent Discovery",
      "layers": [
        "global",
        "hq",
        "framework",
        "routing",
        "knowledge"
      ]
    },
    "boundary": {
      "label": "System Boundary",
      "layers": [
        "routing",
        "tools",
        "tasks",
        "docs",
        "endpoint"
      ]
    }
  }
}